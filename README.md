# Прогнозирование оттока клиентов

## Описание проекта

Это репозиторий моего решения задачи прогнозирования оттока клиентов. Проект представляет собой пример применения машинного обучения для предсказания, уйдет ли клиент (отток) или останется (не отток) в течение 20 дней после открытия займа. Основная цель — разработать модель, которая максимально точно предсказывает отток клиентов, используя данные о клиентах и их займах.

### Основная метрика оценки
Основной метрикой для оценки модели является **F1-Score**, которая отражает баланс между точностью и полнотой предсказаний.

## Описание данных

### Датасет
Заказчик предоставляет данные о клиентах и их займах, включая информацию о доходах, стаже, типе клиента, регионе и других характеристиках. Датасет состоит из следующих файлов:
- **train.csv**: Датасет для обучения модели.
- **test.csv**: Датасет для валидации модели.

### Признаки
Датасет содержит следующие признаки:
- **monthly_income**: Среднемесячный заработок клиента.
- **payment_frequency**: Частота получения зарплаты.
- **status**: Статус клиента (самозанятый, рабочий и т.д.).
- **work_experience**: Количество лет стажа клиента.
- **client_type**: Тип клиента (новый, повторный).
- **settlement**: Город клиента.
- **requested_sum**: Запрашиваемая сумма клиента для займа.
- **region**: Регион клиента (область, округ и т.д.).
- **loan_id**: Уникальный идентификатор займа.
- **client_id**: Уникальный идентификатор клиента.
- **main_agreement_amount**: Основная одобренная сумма по займу.
- **main_agreement_term**: Основной одобренный срок по займу.
- **requested_period_days**: Запрашиваемый срок по займу.
- **requested_amount**: Запрашиваемая сумма по займу.
- **req_app_amount**: Разница между запрашиваемой и одобренной суммой.
- **approved_amount**: Одобренная сумма по займу.
- **source**: Канал привлечения клиента.
- **first_source**: Первый канал привлечения клиента.
- **period_days**: Период страховки по займу.
- **interface**: Интерфейс, откуда пришла заявка (сайт, мобильное приложение).
- **created_at**: Дата открытия займа.
- **type**: Тип займа (тип продукта).
- **closed_at**: Дата закрытия займа.
- **days_finish_loan**: Время в днях, затраченное на закрытие займа.
- **gender**: Пол клиента.
- **ag**: Возраст клиента.
- **repayment_type**: Тип комиссии по займу.
- **loan_order**: Порядковый номер займа.
- **have_extension**: Наличие пролонгации по займу.
- **cnt_ext**: Количество пролонгаций по займу.
- **start_dt**: Дата начала пролонгаций.
- **term**: Срок пролонгации.
- **price**: Цена пролонгации.
- **elecs_sum**: Штрафы и пени.
- **recurents_sum**: Штрафы и пени (различия в этапах начисления).
- **tamount**: Общий кэшфлоу клиента.
- **issues**: Сумма просрочек, штрафов и пени.
- **principal**: Сумма основного долга.
- **interest**: Прибыль с клиента.
- **overdue_interest**: Прибыль с клиента, если есть просрочка.
- **overdue_fee**: Штрафы за просрочку.
- **contact_cases**: Количество обращений клиента в коллекшн.
- **nbki_score**: Скор клиента от рисков.
- **churn**: Целевая переменная (отток клиента или нет).

## Решение

### Используемые инструменты и технологии
- **Python** — основной язык программирования.
- **Pandas** — для обработки и анализа данных.
- **NumPy** — для численных операций.
- **Scikit-learn** — для построения и оценки моделей машинного обучения.
- **CatBoost** — для построения модели градиентного бустинга.
- **Matplotlib и Seaborn** — для визуализации данных.
- **Imbalanced-learn** — для работы с несбалансированными данными.

### Основные шаги решения
1. **Загрузка и предобработка данных**:
   - Загрузка данных из файлов `train.csv` и `test.csv`.
   - Оптимизация типов данных для уменьшения использования памяти.
   - Заполнение пропущенных значений с использованием групповых медиан и других стратегий.
   - Генерация новых признаков, таких как соотношение платежей к доходу, временные характеристики и признаки рискованности клиента.

2. **Обработка категориальных признаков**:
   - Кодирование категориальных признаков с использованием `LabelEncoder`.
   - Очистка и стандартизация названий городов и регионов.

3. **Балансировка данных**:
   - Использование метода `RandomUnderSampler` для балансировки классов целевой переменной.

4. **Обучение модели**:
   - Использование модели **CatBoostClassifier** для обучения.
   - Настройка гиперпараметров модели с помощью **GridSearchCV**.
   - Оценка модели на валидационной выборке с использованием метрики **F1-Score**.

5. **Предсказание и сохранение результатов**:
   - Предсказание оттока клиентов на тестовом наборе данных.
   - Сохранение результатов в файл `submission.csv`.

### Результаты
Модель **CatBoostClassifier** показала следующие результаты:
- **F1-Score на кросс-валидации**: 0.9359.
- **Точность на валидационной выборке**: 0.94.
